---
title: "Linux Shell Notes"
date: 2022-06-06T11:03:30+08:00
layout: post
description: "Linux Shell Notes"
author: "Wenhao Jiang"
draft: false
showFullContent: false
tags:
    - shell
    - linux
URL: "/2022-06-06/shell-notes"
---
# 变量
变量名只能包含数字、字母、下划线

## Shell 提示符

要显示提示符的当前格式，可以使用 echo 输出 PS1 和 PS2

```text
echo $PS1
echo $PS2
```

下表展示了可以在 PS1 和 PS2 中使用的特殊字符。

| 字符   | 描述                                     |
| ---- | -------------------------------------- |
| \a   | 铃声字符                                   |
| \d   | 格式为“日 月 年”的日期                          |
| \e   | ASCII转义字符                              |
| \h   | 本地主机名                                  |
| \H   | 完全合格的限定域主机名                            |
| \j   | shell当前管理的作业数                          |
| \1   | shell终端设备名的基本名称                        |
| \n   | ASCII换行字符                              |
| \r   | ASCII回车                                |
| \s   | shell的名称                               |
| \t   | 格式为“小时:分钟:秒”的24小时制的当前时间                |
| \T   | 格式为“小时:分钟:秒”的12小时制的当前时间                |
| \@   | 格式为am/pm的12小时制的当前时间                    |
| \u   | 当前用户的用户名                               |
| \v   | bash shell的版本                          |
| \V   | bash shell的发布级别                        |
| \w   | 当前工作目录                                 |
| \W   | 当前工作目录的基本名称                            |
| \!   | 该命令的bash shell历史数                      |
| \#   | 该命令的命令数量                               |
| \$   | 如果是普通用户，则为美元符号$；如果超级用户（root 用户），则为井号#。 |
| \nnn | 对应于八进制值 nnn 的字符                        |
| \\   | 斜杠                                     |
| \[   | 控制码序列的开头                               |
| \]   | 控制码序列的结尾                               |

注意，所有的特殊字符均以反斜杠`\`开头，目的是与普通字符区分开来。您可以在命令提示符中使用以上任何特殊字符的组合。

## 赋值

`=` 周围不能有空格

variable='value'

以单引号`' '`包围变量的值时，单引号里面是什么就输出什么，即使内容中有变量和命令（命令需要反引起来）也会把它们原样输出。这种方式比较适合定义显示纯字符串的情况，即不希望解析变量、命令等的场景。

variable="value"

以双引号" "包围变量的值时，输出时会先解析里面的变量和命令，而不是把双引号中的变量名和命令原样输出。这种方式比较适合字符串中附带有变量和命令并且想将其解析后再输出的变量定义。

### 将命令的结果赋值给变量

variable=`command`

variable=$(command) // 推荐使用这种

## 只读变量

readonly a

## 删除变量

unset a

## 变量类型

1) 局部变量

2) 环境变量

3) shell变量

## 特殊变量

| 变量  | 含义                                                |
| --- | ------------------------------------------------- |
| $0  | 当前脚本的文件名                                          |
| $n  | 传递给脚本或函数的参数。n 是一个数字，表示第几个参数。例如，第一个参数是$1，第二个参数是$2。 |
| $#  | 传递给脚本或函数的参数个数。                                    |
| $*  | 传递给脚本或函数的所有参数。                                    |
| $@  | 传递给脚本或函数的所有参数。被双引号(" ")包含时，与 $* 稍有不同              |
| $?  | 上个命令的退出状态，或函数的返回值。                                |
| $$  | 当前Shell进程ID。对于 Shell 脚本，就是这些脚本所在的进程ID。            |

# 命令替换

语法: `command`

```text
DATE=`date`
echo "Date is $DATE"
```

# 变量替换

变量替换可以根据变量的状态（是否为空、是否定义等）来改变它的

可以使用的变量替换形式：

| 形式              | 说明                                                                                               |
| --------------- | ------------------------------------------------------------------------------------------------ |
| ${var}          | 变量本来的值                                                                                           |
| ${var:-word}    | 如果变量 var 为空或已被删除(unset)，那么返回 word，但不改变 var 的值。                                                   |
| ${var:=word}    | 如果变量 var 为空或已被删除(unset)，那么返回 word，并将 var 的值设置为 word。                                             |
| ${var:?message} | 如果变量 var 为空或已被删除(unset)，那么将消息 message 送到标准错误输出，可以用来检测变量 var 是否可以被正常赋值。若此替换出现在Shell脚本中，那么脚本将停止运行。 |
| ${var:+word}    | 如果变量 var 被定义，那么返回 word，但不改变 var 的值。                                                              |

## 获取字符串长度

```text
string="abcd"
echo ${#string} #输出 4
```

## 提取子字符串

```text
string="alibaba is a great company"
echo ${string:1:4} #输出liba
```

## 查找子字符串

```text
string="alibaba is a great company"
echo `expr index "$string" is`
```
